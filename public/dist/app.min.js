!function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module){module.exports=function(app){app.controller("HomeController",["$scope",require("./controllers/home.js")]),app.controller("RegisterController",["$scope",require("./controllers/register.js")]),app.controller("ProfileController",["$scope",require("./controllers/profile.js")]),app.controller("CreateCorpusController",["$scope",require("./controllers/createcorpus.js")])}},{"./controllers/createcorpus.js":5,"./controllers/home.js":6,"./controllers/profile.js":7,"./controllers/register.js":8}],2:[function(require,module){var facetsData,types,entities,articles,FacetsProcesser=require("../../modules/FacetsProcesser");module.exports=function($scope,$state,$sce){$scope.typeFilter=void 0,$scope.entityFilter=void 0,$scope.articleFilter=void 0,$scope.setFilter=function(item){switch(item.type){case"article":$scope.articleFilter=$scope.articleFilter===item.id?void 0:item.id;break;case"entity":$scope.entityFilter=$scope.entityFilter===item.id?void 0:item.id;break;case"type":$scope.typeFilter=$scope.typeFilter===item.id?void 0:item.id}},$scope.itemActive=function(item){switch(item.type){case"article":return $scope.articleFilter===item.id;case"entity":return $scope.entityFilter===item.id;case"type":return $scope.typeFilter===item.id}},$scope.facetFilter=function(item){var filterArticle=!1,filterEntity=!1,filterType=!1;switch(item.type){case"article":return filterEntity=void 0!==$scope.entityFilter?-1!==item.entities.indexOf($scope.entityFilter):!0,filterType=void 0!==$scope.typeFilter?-1!==item.types.indexOf($scope.typeFilter):!0,filterEntity&&filterType;case"entity":return filterArticle=void 0!==$scope.articleFilter?-1!==item.articles.indexOf($scope.articleFilter):!0,filterType=void 0!==$scope.typeFilter?-1!==item.types.indexOf($scope.typeFilter):!0,filterArticle&&filterType;case"type":return filterArticle=void 0!==$scope.articleFilter?-1!==item.articles.indexOf($scope.articleFilter):!0,filterEntity=void 0!==$scope.entityFilter?-1!==item.entities.indexOf($scope.entityFilter):!0,filterArticle&&filterEntity}},$.getJSON("/api/corpus/"+$scope.currentCorpus._id+"/facets",function(data){facetsData=FacetsProcesser.processData(data),types=facetsData.types,entities=facetsData.entities,articles=facetsData.articles;for(var i=0;i<articles.length;i++)articles[i].sourceSafe=$sce.trustAsHtml(articles[i].source);$scope.data=[{name:"Articles",values:articles},{name:"Types",values:types},{name:"Entities",values:entities}],$state.reload()})}},{"../../modules/FacetsProcesser":15}],3:[function(require,module){var extentions=require("../../data/corpusextentions"),currentCorpus={uri:function(){var it=this.input_type;return"twitter"===it?"http://twitter.com/"+this.input:"direct"===it?"-":this.input}},initProgressWebsocket=function($scope){var location=document.URL.split("://")[1].replace("/overview",""),socket=new WebSocket("ws://"+location);socket.onerror=function(err){console.log(err)},socket.onopen=function(){$scope.$apply(function(){$scope.progress.show=!0})},socket.onmessage=function(event){var data=JSON.parse(event.data);$scope.$apply(function(){$scope.progress.type=data.type,$scope.progress.progress=data.progress})},socket.onclose=function(){$scope.$apply(function(){$scope.progress.show=!1})}};module.exports=function($scope,$location,$state,corpus){currentCorpus=_.extend(currentCorpus,corpus.data),$scope.currentCorpus=currentCorpus,$scope.Math=Math,$scope.progress={show:!1,progress:0,type:""},$scope.extentions=extentions,$scope.$state=$state,$scope.$on("$viewContentLoaded",function(){initProgressWebsocket($scope);var len=$location.path().split("/").length;3===len&&$state.go("corpus."+extentions[0].name)})}},{"../../data/corpusextentions":10}],4:[function(require,module){module.exports=function(){console.log("corpus overview")}},{}],5:[function(require,module){var corpusTypes=require("../data/corpusTypes.js"),nlpApis=require("../data/nlpApis.js");module.exports=function($scope){$scope.corpusTypes=corpusTypes,$scope.nlpApis=nlpApis,$scope.corpusSelection={index:0},$scope.currentCorpus=$scope.corpusTypes[0];var $inputCount,$sliderContainer,updateView=function(){console.log("view loaded!"),$scope.currentCorpus=$scope.corpusTypes[$scope.corpusSelection.index],$scope.currentCorpus.haveItems?($inputCount?$inputCount.slider("destroy"):($sliderContainer=$("#slider_container"),$inputCount=$("#input_count")),$sliderContainer.show(),$inputCount.slider({min:$scope.currentCorpus.itemsMin,max:$scope.currentCorpus.itemsMax,step:50,value:$scope.currentCorpus.itemsDefault,tooltip:"always"})):$sliderContainer.hide()};$scope.$watch("corpusSelection",updateView,!0),$scope.$on("$viewContentLoaded",updateView),$scope.startAnalysis=function(){var $inputItem=$("#input_item"),$inputItemArea=$("#input_item_area"),$inputItemFile=$("#input_item_file"),$inputCountField=$("input#input_count"),$newCorpusForm=$("#newcorpus_form"),$inputType=$("input[name=input_type]:checked");$inputItem.parent().removeClass("has-warning");var input=null,corpusType=$scope.currentCorpus.name,inputType=$scope.currentCorpus.inputType;switch(inputType){case"text":input=$inputItem.val().trim();break;case"textarea":input=$inputItemArea.val().trim();break;case"file":input=$inputItemFile.val()}if(!input)return void $inputItem.parent().addClass("has-warning");var itemCount=$inputCount.slider("getValue");switch($inputCountField.val(itemCount),inputType){case"text":$inputItem.attr("name","input"),$inputItemArea.remove(),$inputItemFile.remove();break;case"textarea":$inputItem.remove(),$inputItemArea.attr("name","input"),$inputItemFile.remove();break;case"file":$inputItem.remove(),$inputItemArea.remove(),$inputItemFile.attr("name","input")}$inputType.val(corpusType),$newCorpusForm.submit()}}},{"../data/corpusTypes.js":9,"../data/nlpApis.js":11}],6:[function(require,module){module.exports=function($scope){$scope.corpus="0",$scope.corpusSelect=function(){"0"!==$scope.corpus&&(window.location="/corpus/"+$scope.corpus)}}},{}],7:[function(require,module){module.exports=function(){}},{}],8:[function(require,module){module.exports=function(){}},{}],9:[function(require,module){var collection=[];collection.push({name:"feed",description:"RSS/RDF/ATOM Feed",inputType:"text",inputDescription:"URL of the RSS/RDF/ATOM feed",inputPlaceholder:"URL of your feed",haveItems:!0,itemsMin:50,itemsMax:600,itemsDefault:50}),collection.push({name:"wordpress",description:"WordPress Blog",inputType:"text",inputDescription:"Weblog URL",inputPlaceholder:"URL of the blog",haveItems:!0,itemsMin:50,itemsMax:400,itemsDefault:400}),collection.push({name:"blogger",description:"Blogger Blog",inputType:"text",inputDescription:"Weblog URL",inputPlaceholder:"URL of the blog",haveItems:!0,itemsMin:50,itemsMax:400,itemsDefault:400}),collection.push({name:"twitter",description:"Public Twitter account",inputType:"text",inputDescription:"Twitter username",inputPlaceholder:"Username",haveItems:!0,itemsMin:200,itemsMax:1500,itemsDefault:1e3}),collection.push({name:"slidewiki",description:"SlideWiki Deck",inputType:"text",inputDescription:"Deck ID",inputPlaceholder:"Deck ID",haveItems:!0,itemsMin:50,itemsMax:1e3,itemsDefault:400}),collection.push({name:"webpage",description:"Web page",inputType:"text",inputDescription:"WebPage URL",inputPlaceholder:"URL",haveItems:!1}),collection.push({name:"directinput",description:"Direct input",inputType:"textarea",inputDescription:"Your text/html",haveItems:!1}),collection.push({name:"doc",description:"Upload a document",inputType:"file",inputDescription:"Document",haveItems:!1}),module.exports=collection},{}],10:[function(require,module){var collection=[];collection.push({name:"Overview",path:"/overview",controller:"CorpusOverviewController",template:"/templates/corpusOverview.html",js:require("../controllers/corpus/overview.js")}),collection.push({name:"Facets",path:"/facets",controller:"CorpusFacetsController",template:"/templates/corpusFacets.html",js:require("../controllers/corpus/facets.js")}),module.exports=collection},{"../controllers/corpus/facets.js":2,"../controllers/corpus/overview.js":4}],11:[function(require,module){var collection=[];collection.push({id:"DBpedia-Spotlight",name:"DBpedia Spotlight"}),collection.push({id:"FOX",name:"FOX"}),module.exports=collection},{}],12:[function(require,module){module.exports=function(){}},{}],13:[function(require){var app=(require("./modules/corpus"),angular.module("context-app",["ngRoute","ngAnimate","mgcrea.ngStrap","CorpusModule"]));require("./routes")(app),require("./services")(app),require("./controllers")(app),require("./directives")(app),require("./filters")(app)},{"./controllers":1,"./directives":12,"./filters":14,"./modules/corpus":16,"./routes":17,"./services":18}],14:[function(require,module){module.exports=function(){}},{}],15:[function(require,module,exports){var escapeRegExp=function(str){return str.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},processData=function(data){var articles=[],types=[],typeNames=[],entities=[],entityNames=[];data.articles.forEach(function(item){var title="";try{var dom=$(item.source);title=$("extracted-title",dom).text()||dom.text()}catch(e){title=item.source}title=title.slice(0,30)+"...";for(var article={id:item._id,name:title,type:"article",count:0,entities:[],types:[],source:item.source},sourceText=S(item.source).stripTags().s,srcText=sourceText.split(/\s/),src=item.source.split(/\s/),i=0;i<srcText.length;i++){var it=srcText[i];it=it.split("/"),srcText[i]=it}srcText=_.flatten(srcText);var findSourceIndex=function(word,cleanWord,entityName,startIndex){startIndex=startIndex||-1;var sourceIndex=src.indexOf(word,startIndex);if(-1===sourceIndex)for(var i=0;i<src.length;i++){var srcWord=src[i],srcWordClean=srcWord.replace(/href="(.+?)"(.*?>?)/,"").replace(/src="(.+?)"(.*?>?)/,"").replace(/alt="(.+?)"(.*?>?)/,"");if(-1===srcWordClean.indexOf("span%marked%")&&srcWordClean.match(new RegExp(matchRegStart+escapeRegExp(cleanWord)+matchReg))&&i>=startIndex){sourceIndex=i;break}}return sourceIndex},cleanReg=/(^[\W]+)|([\W]+$)/g,matchRegStart="",matchReg="(\\W?)";item.entities.forEach(function(entity){var entityParts=entity.name.split(" ");if(1===entityParts.length)srcText.forEach(function(word){{var cleanWord=word.replace(cleanReg,"");entity.name.replace(cleanReg,"")}if(cleanWord!==entity.name&&word!==entity.name);else{var sourceIndex=findSourceIndex(word,cleanWord,entity.name);if(-1!==sourceIndex){var origSrc=src[sourceIndex],link=origSrc.match(/href="(.+?)"/),img=origSrc.match(/src="(.+?)"/),alt=origSrc.match(/alt="(.+?)"/);link&&(link=link[1],origSrc=origSrc.replace(link,"%link%")),img&&(img=img[1],origSrc=origSrc.replace(img,"%img%")),alt&&(alt=alt[1],origSrc=origSrc.replace(alt,"%alt%")),src[sourceIndex]=origSrc.replace(entity.name,'<span%marked% class="label label-warning hasTooltip" data-toggle="tooltip" title="'+entity.types.join(" ")+'">'+entity.name+"</span%marked%>"),link&&(src[sourceIndex]=src[sourceIndex].replace("%link%",link)),img&&(src[sourceIndex]=src[sourceIndex].replace("%img%",img)),alt&&(src[sourceIndex]=src[sourceIndex].replace("%alt%",alt))}}});else{var firstWord=entityParts[0],lastWord=entityParts[entityParts.length-1];srcText.forEach(function(word,index){var cleanWord=word.replace(cleanReg,"");if(-1===cleanWord.indexOf("span%marked%")){var match=null!==firstWord.match(new RegExp(matchRegStart+escapeRegExp(cleanWord)+matchReg));if(match){var i=0;for(i=1;i<entityParts.length;i++)if(!(index+i>=srcText.length)){var nextCleanWord=srcText[index+i].replace(cleanReg,"");-1===nextCleanWord.indexOf("span%marked%")&&(match=match&&null!==entityParts[i].match(new RegExp(matchRegStart+escapeRegExp(nextCleanWord)+matchReg)))}if(match){var sourceStartIndex=findSourceIndex(word,cleanWord,firstWord,index),endIndex=index+entityParts.length-1;if(endIndex>=srcText.length)return;var endWord=srcText[endIndex],endCleanWord=endWord.replace(/[^\w]/,""),sourceEndIndex=findSourceIndex(endWord,endCleanWord,lastWord,endIndex);-1!==sourceStartIndex&&-1!==sourceEndIndex&&Math.abs(sourceStartIndex-sourceEndIndex)<5&&(src[sourceStartIndex]=src[sourceStartIndex].replace(new RegExp(escapeRegExp(firstWord)+"$"),'<span%marked% class="label label-warning hasTooltip" data-toggle="tooltip" title="'+entity.types.join(" ")+'">'+firstWord),src[sourceEndIndex]=src[sourceEndIndex].replace(lastWord,lastWord+"</span%marked%>"))}}else;}})}var newEntity,ind=entityNames.indexOf(entity.name);-1!==ind?(newEntity=entities[ind],entities[ind].count+=1,-1===entities[ind].articles.indexOf(article.id)&&entities[ind].articles.push(article.id),-1===article.entities.indexOf(newEntity.id)&&article.entities.push(newEntity.id)):(newEntity={id:entity._id,name:entity.name,type:"entity",count:1,articles:[article.id],types:[]},article.entities.push(newEntity.id)),entity.types.forEach(function(type){var name=type.split(":")[1],tid="type_"+name,ind=typeNames.indexOf(name);-1!==ind?(types[ind].count+=1,types[ind].entities.push(newEntity.id),types[ind].articles.push(article.id),-1===newEntity.types.indexOf(tid)&&newEntity.types.push(tid),-1===article.types.indexOf(tid)&&article.types.push(tid)):(types.push({id:tid,name:name,type:"type",count:1,entities:[newEntity.id],articles:[article.id]}),-1===newEntity.types.indexOf(tid)&&newEntity.types.push("type_"+name),-1===article.types.indexOf(tid)&&article.types.push("type_"+name),typeNames.push(name))}),-1===ind&&(entities.push(newEntity),entityNames.push(newEntity.name))}),item.source=src.join(" ").replace(/span%marked%/g,"span"),article.source=item.source,articles.push(article)});var sortFunction=function(a,b){return b.count-a.count};return entities=entities.sort(sortFunction),types=types.sort(sortFunction),{articles:articles,types:types,entities:entities}};exports.processData=processData},{}],16:[function(require,module){var extentions=require("../data/corpusextentions"),corpusModule=angular.module("CorpusModule",["ui.router"]);corpusModule.config(function($stateProvider){$stateProvider.state("corpus",{url:"/corpus/:id",controller:require("../controllers/corpus/main"),templateUrl:"/templates/corpusView.html",resolve:{corpus:["$http","$stateParams",function($http,$stateParams){return $http({method:"GET",url:"/api/corpus/"+$stateParams.id})}]}}),extentions.forEach(function(ex){$stateProvider.state("corpus."+ex.name,{url:ex.path,templateUrl:ex.template,controller:ex.controller})})}),extentions.forEach(function(ex){corpusModule.controller(ex.controller,["$scope","$state","$sce",ex.js])}),module.exports=corpusModule},{"../controllers/corpus/main":3,"../data/corpusextentions":10}],17:[function(require,module){module.exports=function(app){app.config(["$routeProvider","$locationProvider",function($routeProvider,$locationProvider){$routeProvider.when("/",{controller:"HomeController",template:""}),$routeProvider.when("/auth",{controller:"LoginController",template:""}),$routeProvider.when("/register",{controller:"RegisterController",template:""}),$routeProvider.when("/createCorpus",{controller:"CreateCorpusController",templateUrl:"/templates/createCorpus.html"}),$locationProvider.html5Mode(!0)}])}},{}],18:[function(require,module){module.exports=function(){}},{}]},{},[13]);